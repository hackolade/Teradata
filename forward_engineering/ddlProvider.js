"use strict";var Pe=Object.defineProperty;var c=(m,y)=>Pe(m,"name",{value:y,configurable:!0});var V=(m,y)=>()=>(y||m((y={exports:{}}).exports,y),y.exports);var te=V((Ge,ee)=>{"use strict";ee.exports={createDatabase:'CREATE DATABASE "${name}" AS ${databaseOptions};',createSession:'SET SESSION DATABASE "${name}";',columnDefinition:'"${name}" ${type}${inlineLength}${not_null}${uppercase}${caseSpecific}${format}${default}${storageFormat}${characterSet}${withSchema}${autoColumn}${compress}${compressUsing}${decompressUsing}${inlineCheckConstraint}${inlineUniqueConstraint}${inlinePKConstraint}',createTable:"CREATE${tableSet}${temporary}${traceTable} TABLE ${name}${tableOptions} (\n		${column_definitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n	)${tableIndexes}${tablePreservation};\n",createAsSelectTable:"CREATE${tableSet}${temporary} TABLE ${name}${tableOptions} (\n		${column_definitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n	)\n	AS (\n	${selectStatement} \n	)${tableIndexes}${tablePreservation};\n",createErrorTable:"CREATE ERROR TABLE ${tableName} FOR ${targetDataTable};\n",createForeignTable:"CREATE FOREIGN TABLE ${name}${tableOptions} (\n		${column_definitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n	)\n	USING (\n	${usingOptions}\n	)${tableIndexes}${tablePreservation};\n",createHashIndex:"CREATE HASH INDEX ${indexName}${indexOptions} (\n		${indexKeys}\n	)\n	ON ${tableName}${orderBy};\n",createJoinIndex:"CREATE JOIN INDEX ${indexName}${indexOptions}\n	AS ${selectStatement};\n",createKeyConstraint:"CONSTRAINT ${constraintName}${constraintType}${columns}",checkConstraint:"${name}${expression}",createForeignKeyConstraint:"FOREIGN KEY (${foreignKey}) REFERENCES ${checkOption} ${primaryTable} (${primaryKey})",createView:"CREATE${recursive} VIEW ${name} (\n	${columnList}\n)\nAS ${selectStatement};\n",viewSelectStatement:"SELECT ${keys}\n	FROM ${tableName}",createStructuredType:`CREATE TYPE \${typeName} AS (
	\${columnDefinitions}
)
NOT FINAL\${methodSpecification};
`,createDistinctType:"CREATE TYPE ${typeName} AS ${baseType} FINAL${methodSpecification};\n",createArrayType:"CREATE TYPE ${typeName} AS ${baseType}${default};\n",dropDatabase:'DROP DATABASE "${databaseName}";\n',modifyDatabase:'MODIFY DATABASE "${databaseName}" AS ${databaseOptions};\n',dropTable:"DROP ${temporary}TABLE ${name};\n",alterTable:"ALTER TABLE ${tableName}${tableOptions}${alterStatement};",addColumn:" ADD ${columnDefinition}",dropColumn:" DROP ${name}",rename:" RENAME ${oldName} TO ${newName}",dropCheckConstraint:" DROP CONSTRAINT ${name} CHECK",addCheckConstraint:" ADD CONSTRAINT ${name} ${expression}",modifyCheckConstraint:" MODIFY CONSTRAINT ${name} ${expression}",dropSecondaryIndex:"DROP INDEX ${indexName} ON ${tableName};",dropIndex:"DROP${indexType} INDEX ${indexName};",dropView:"DROP VIEW ${viewName};",renameView:"RENAME VIEW ${oldViewName} TO ${newViewName};"}});var re=V((xe,ne)=>{"use strict";ne.exports={number:"NUMBER",string:"TEXT",date:"DATE",timestamp:"TIMESTAMP",binary:"BYTE",boolean:"NUMBER",document:"OBJECT",array:"ARRAY",objectId:"VARCHAR(24)",default:"CHAR"}});var se=V((Ve,ae)=>{"use strict";ae.exports={BYTEINT:{capacity:1},SMALLINT:{capacity:2},INT:{capacity:4},INTEGER:{capacity:4},BIGINT:{capacity:8},DECIMAL:{mode:"decimal"},DEC:{mode:"decimal"},NUMERIC:{mode:"decimal"},FLOAT:{capacity:4,mode:"float"},"DOUBLE PRECISION":{capacity:8,mode:"float"},REAL:{capacity:8,mode:"float"},NUMBER:{mode:"number"},CHAR:{mode:"char"},CHARACTER:{mode:"char"},VARCHAR:{mode:"varchar"},"CHAR VARYING":{mode:"varchar"},"CHARACTER VARYING":{mode:"varchar"},"LONG VARCHAR":{mode:"long varchar"},VARGRAPHIC:{mode:"vargraphic"},"LONG VARGRAPHIC":{mode:"long vargraphic"},CLOB:{mode:"clob"},"CHARACTER LARGE OBJECT":{mode:"clob"},BYTE:{mode:"byte"},VARBYTE:{mode:"varbyte"},BLOB:{mode:"blob"},DATE:{format:"YYYY-MM-DD"},TIME:{format:"hh:mm:ss"},TIMESTAMP:{format:"YYYY-MM-DD hh:mm:ss"},ST_Geometry:{mode:"ST_Geometry"},MBR:{mode:"MBR"},MBB:{mode:"MBB"},JSON:{},XML:{},XMLTYPE:{},DATASET:{},PERIOD:{},"INTERVAL YEAR":{},"INTERVAL MONTH":{},"INTERVAL DAY":{},"INTERVAL HOUR":{},"INTERVAL MINUTE":{},"INTERVAL SECOND":{}}});var oe=V((Ye,ie)=>{"use strict";var Ue=c(m=>Array.isArray(m)?m.reduce((y,B)=>({...y,[B.id]:B.value}),{}):{},"getAdditionalOptions");ie.exports=Ue});var le=V((He,ce)=>{"use strict";var he=c(({commentIfDeactivated:m})=>(y,B)=>{let O=!1;return{...B,...["dropDatabase","dropTable","dropColumn","dropIndex","dropCheckConstraint","dropView"].reduce((E,M)=>({...E,[M]:(...b)=>{let f=B[M](...b);return O=O||!!f,y||!f?f:m(f,{isActivated:!1})}}),{}),isDropInStatements(){return O}}},"dropStatementProxy");ce.exports=he});var me=V((Je,de)=>{"use strict";de.exports=({_:m,commentIfDeactivated:y,checkAllKeysDeactivated:B,divideIntoActivatedAndDeactivated:O,assignTemplates:E})=>({generateConstraintsString:c((_,K)=>{let d=y((_?.deactivatedItems||[]).join(`,
		`),{isActivated:!K,isPartOfLine:!0}),A=_?.activatedItems?.length?`,
		`+_.activatedItems.join(`,
		`):"",u=_?.deactivatedItems?.length?`
		`+d:"";return A+u},"generateConstraintsString"),foreignKeysToString:c(_=>{if(Array.isArray(_)){let K=_.filter(u=>m.get(u,"isActivated",!0)).map(u=>`"${m.trim(u.name)}"`),d=_.filter(u=>!m.get(u,"isActivated",!0)).map(u=>`"${m.trim(u.name)}"`),A=d.length?y(d,{isActivated:!1,isPartOfLine:!0}):"";return K.join(", ")+A}return _},"foreignKeysToString"),foreignActiveKeysToString:c(_=>_.map(K=>m.trim(K.name)).join(", "),"foreignActiveKeysToString"),createKeyConstraint:c((_,K)=>d=>{let A=c(({name:g})=>`"${g}"`,"columnMapToString"),u=B(d.columns),a=O(d.columns,A),o=a?.deactivatedItems?.length?y(a.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"",p=!u&&K?" ("+a.activatedItems.join(", ")+o+")":" ("+d.columns.map(A).join(", ")+")";return{statement:E(_.createKeyConstraint,{constraintName:d.name?`"${m.trim(d.name)}" `:"",constraintType:d.keyType,columns:p}),isActivated:!u}},"createKeyConstraint")})});var Ae=V((qe,Ee)=>{"use strict";Ee.exports=(m,y)=>{let B=c((a,o)=>Object.entries(a.properties).map(o),"mapProperties"),O=c(a=>a.compositeUniqueKey?!1:!!a.unique,"isUniqueKey"),E=c(a=>a.compositeUniqueKey||a.compositePrimaryKey?!1:!!a.primaryKey,"isPrimaryKey"),M=c(a=>O(a)&&m.isEmpty(a.uniqueKeyConstraintName),"isInlineUnique"),b=c(a=>E(a)&&m.isEmpty(a.primaryKeyConstraintName),"isInlinePrimaryKey"),f=c((a,o,p,g)=>y({keyType:o,name:a,columns:[{name:p,isActivated:g}]}),"hydrateKeyConstraintOptions"),v=c((a,o)=>Object.keys(o).find(p=>o[p].GUID===a),"findName"),_=c((a,o)=>m.get(Object.values(o).find(p=>p.GUID===a),"isActivated",!0),"checkIfActivated"),K=c((a,o)=>m.map(a,p=>({name:v(p.keyId,o.properties),isActivated:_(p.keyId,o.properties)})),"getKeys"),d=c(a=>Array.isArray(a.primaryKey)?a.primaryKey.filter(o=>!m.isEmpty(o.compositePrimaryKey)).map(o=>({...f(o.constraintName,"PRIMARY KEY",null,a),columns:K(o.compositePrimaryKey,a)})):[],"getCompositePrimaryKeys"),A=c(a=>Array.isArray(a.uniqueKey)?a.uniqueKey.filter(o=>!m.isEmpty(o.compositeUniqueKey)).map(o=>({...f(o.constraintName,"UNIQUE",null,a),columns:K(o.compositeUniqueKey,a)})):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:c(a=>{if(!a.properties)return[];let o=B(a,([g,R])=>{if(!(!E(R)||m.isEmpty(R.primaryKeyConstraintName)))return f(R.primaryKeyConstraintName,"PRIMARY KEY",g,R.isActivated)}).filter(Boolean),p=m.flatten(B(a,([g,R])=>{if(!(!O(R)||m.isEmpty(R.uniqueKeyConstraintName)))return f(R.uniqueKeyConstraintName,"UNIQUE",g,R.isActivated)})).filter(Boolean);return[...o,...d(a),...p,...A(a)]},"getTableKeyConstraints"),isInlineUnique:M,isInlinePrimaryKey:b}}});var ue=V((Xe,Te)=>{"use strict";Te.exports=(m,y,B)=>{let O=c((A,u)=>{if(!u)return A.map(p=>`"${p.name}"`).join(`,
	`);let a=A.filter(p=>p.isActivated).map(p=>`"${p.name}"`),o=A.filter(p=>!p.isActivated).map(p=>`"${p.name}"`);return a.length===0?B(o.join(`,
	`),{isActivated:!1},!0):o.length===0?a.join(`,
	`):a.join(`,
	`)+`
	`+B(o.join(`,
	`),{isActivated:!1},!0)},"viewColumnsToString"),E=c((A,u)=>u?`"${u}"."${A}"`:`"${A}"`,"getTableName"),M=E,b=c((A,u)=>A?`"${A}"."${u}"`:u,"getDefaultJournalTableName"),f=c((A,u)=>A===u?`${u} JOURNAL`:`${A} ${u} JOURNAL`,"getJournalingStrategy"),v=c(({db_account:A,db_default_map:u,db_permanent_storage_size:a,spool_files_size:o,has_fallback:p,db_before_journaling_strategy:g,db_after_journaling_strategy:R,db_default_journal_table:w,db_default_journal_db:j,dropDefaultJournalTable:q})=>{let x=c((H,D,i=!1)=>l=>H?[...l,D]:i?[...l,i]:l,"add"),z=`${q?"DROP ":""}DEFAULT JOURNAL TABLE = ${b(j,w)}`;return m.flow([x(a,`PERMANENT = ${a}`),x(o,`SPOOL = ${o}`),x(A,`ACCOUNT = ${A}`),x(u,`DEFAULT MAP = ${u}`),x(p,"FALLBACK","NO FALLBACK"),x(g,f(g,"BEFORE")),x(R,f(R,"AFTER")),x(w,z),H=>y(`
 `+H.join(`,
 `))])([])},"getDatabaseOptions"),_=c(A=>A?A.alias?`"${A.name}" AS "${A.alias}"`:`"${A.name}"`:"","getKeyWithAlias");return{getTableName:E,getIndexName:M,getJournalingStrategy:f,getDefaultJournalTableName:b,getDatabaseOptions:v,getViewData:c(A=>Array.isArray(A)?A.reduce((u,a)=>{if(!a.tableName)return u.columns.push(_(a)),u;let o=`"${a.dbName}"."${a.tableName}"`;return u.tables.includes(o)||u.tables.push(o),u.columns.push({statement:`${o}.${_(a)}`,isActivated:a.isActivated}),u},{tables:[],columns:[]}):{tables:[],columns:[]},"getViewData"),viewColumnsToString:O,shouldDropDefaultJournalTable:c(A=>!!(A.old.db_default_journal_db&&A.old.db_default_journal_table&&!A.new.db_default_journal_db&&!A.new.db_default_journal_table),"shouldDropDefaultJournalTable")}}});var Se=V((Ze,pe)=>{"use strict";pe.exports=({_:m,tab:y,getJournalingStrategy:B,commentIfDeactivated:O,divideIntoActivatedAndDeactivated:E})=>{let M=c(i=>i?.percentUnit?`${i.freeSpaceValue} PERCENT`:i?.freeSpaceValue||"","getFreeSpaceValue"),b=c((i={})=>{if(i.mergeRatio==="SPECIFIC"&&i.specificRatio){let l=i.percentUnit?"PERCENT":"";return`MERGEBLOCKRATIO = ${i.specificRatio} ${l}`}return`${i.mergeRatio} MERGEBLOCKRATIO`},"getMergeBlockRatio"),f=c((i={})=>{if(i.blockSize==="SPECIFIC"&&i.specificSize){let l=i.units?` ${i.units}`:"";return i.blockSize+l}return`${i.blockSize} DATABLOCKSIZE`},"getDataBlockSize"),v=c((i,l)=>i==="SPECIFIC"&&l?`BLOCKCOMPRESSIONLEVEL = ${l}`:`BLOCKCOMPRESSIONLEVEL = ${i}`,"getBlockCompressionLevel"),_=c((i={})=>m.flow([d(!!i.blockCompressionType,`BLOCKCOMPRESSION = ${i.blockCompressionType}`),d(!!i.blockCompressionType,`BLOCKCOMPRESSIONALGORITHM = ${i.blockCompressionAlgorithm}`),d(!!i.blockCompressionLevel,v(i.blockCompressionLevel,i.specificBlockCompressionLevel))])([]),"getBlockCompression"),K=c(i=>["NO","CONCURRENT"].includes(i)?`WITH ${i} ISOLATED LOADING`:`WITH ISOLATED LOADING ${i}`,"getIsolatedLoading"),d=c((i,l,N=!1)=>$=>i?m.flatten([...$,l]):N?[...$,N]:$,"add"),A=c(i=>{let l=y(i.join(`,
`));return m.isEmpty(i)?l:`,
`+l},"formatTableOptions"),u=c(({FALLBACK:i,BEFORE_JOURNAL:l,AFTER_JOURNAL:N,DEFAULT_JOURNAL_TABLE:$,FREESPACE:U,TABLE_CHECKSUM:e,LOG:t,MAP:s,COLOCATE_USING:n,ISOLATED_LOADING:r,MERGE_BLOCK_RATIO:T,DATA_BLOCK_SIZE:I,BLOCK_COMPRESSION:L,QUEUE_TABLE:S,EXTERNAL_SECURITY:h,AUTHORIZATION_NAME:P},F=!1)=>m.flow([d(S,"QUEUE"),d(!!s,`MAP = ${s}${n?` COLOCATE USING ${n}`:""}`),d(i,"FALLBACK",F?"":"NO FALLBACK"),d(!!$,`WITH JOURNAL TABLE = ${$}`),d(t,"LOG",F?"":"NO LOG"),d(!!l,B(l,"BEFORE")),d(!!N,B(l,"AFTER")),d(!!e,`CHECKSUM = ${e}`),d(!!U?.freeSpaceValue,`FREESPACE = ${M(U)}`),d(!!T?.mergeRatio,b(T)),d(!!I?.blockSize,f(I)),d(!!L?.blockCompressionType,_(L)),d(!!r,K(r)),d(!!h,`EXTERNAL SECURITY ${h} TRUSTED${P?" "+P:""}`),A])([]),"getTableOptions"),a=c((i,l)=>{let N="";return N+=l?" ":"",N+=!i||i==="SECONDARY"?"INDEX":`${i} INDEX`,N},"getIndexType"),o=c((i=[])=>{if(m.isEmpty(i))return"";let l=E(i,$=>`"${$.name}"`);if(m.isEmpty(l.activatedItems))return l.deactivatedItems.join(", ");let N=l.deactivatedItems.length?O(l.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"";return l.activatedItems.join(", ")+N},"getIndexKeys"),p=c(({indexMap:i,colocateUsing:l,indexFallback:N,checksum:$,blockCompression:U})=>m.flow([d(i,`MAP = ${i}${l?` COLOCATE USING ${l}`:""}`),d(N,"FALLBACK","NO FALLBACK"),d($,`CHECKSUM = ${$}`),d(U,`BLOCKCOMPRESSION = ${U}`),A])([]),"getIndexOptions"),g=c(({isActivated:i,unique:l,indexType:N,all:$,indxKey:U,indxName:e,orderBy:t,orderKeys:s,loadIdentity:n})=>{if(m.isEmpty(U))return"";let r="";return r+=l?"UNIQUE":"",r+=a(N,l),r+=e?` "${e}"`:"",r+=$?" ALL":"",r+=m.isEmpty(U)?"":` ( ${o(U)} )`,r+=t?` ORDER BY ${t}`:"",r+=m.isEmpty(s)?"":` ( ${o(s)} )`,r+=n?` ${n}`:"",O(r,{isActivated:i})},"getTableInlineIndexStatement"),R=c(i=>i.map(g),"getTableInlineIndexStatements"),w=c(i=>{let l=i.find(N=>["PRIMARY","PRIMARY AMP"].includes(N.indexType)&&!m.isEmpty(N.indxKey));return l||{}},"findPrimaryIndex"),j=c(i=>i.filter(l=>(!l.indexType||l.indexType==="SECONDARY")&&!m.isEmpty(l.indxKey)),"filterSecondaryIndexes"),q=m.flow([w,g]),x=m.flow([j,R,m.compact]),Q=c(i=>i.map(l=>{let N="";return N+=l.columnFormat?l.columnFormat:"",N+=l.name&&l.columnFormat?` "${l.name}"`:`"${l.name}"`,N+=l.autoCompression?` ${l.autoCompression}`:"",N}),"getPartitionKeys"),z=c((i={})=>{let l="PARTITION BY";return l+=i.partitionBy==="column"?" COLUMN":"",l+=i.partitioningExpression?` ${i.partitioningExpression}`:"",l+=i.compositePartitionKey?` (
	${Q(i.compositePartitionKey).join(`,
	`)}
)`:"",l},"getPartitions");return{getTableOptions:u,getUsingOptions:c(({location:i,scanPercentage:l,pathPattern:N,manifest:$,tableFormat:U,rowFormat:e,storedAs:t,header:s,stripSpaces:n,stripEnclosingChar:r})=>m.flow([d(i,`LOCATION ( '${i}' )`),d(l,`SCANPCT = '${l}'`),d(N,`PATHPATTERN ( '${N}' )`),d($,"MANIFEST ( 'TRUE' )","MANIFEST ( 'FALSE' )"),d(U,`TABLE_FORMAT ( '${U}' )`),d(e,`ROWFORMAT ( '${e}' )`),d(t,`STOREDAS ( '${t}' )`),d(s,"HEADER ( 'TRUE' )","STRIP_EXTERIOR_SPACES ( 'FALSE' )"),d(n,"STRIP_EXTERIOR_SPACES ( 'TRUE' )","STRIP_EXTERIOR_SPACES ( 'FALSE' )"),d(r,`STRIP_ENCLOSING_CHAR ( '${r}' )`),T=>y(T.join(`
	`))])([]),"getUsingOptions"),getInlineTableIndexes:c(i=>{let l=q(i.tableIndexes||[]),N=m.isEmpty(i.partitioning.partitioningExpression)&&m.isEmpty(i.partitioning.compositePartitionKey)?"":z(i.partitioning),$=x(i.tableIndexes||[]);if(!l&&!N&&m.isEmpty($))return"";let U="";return U+=l||"",U+=N?`
`+N:"",`
`+y([U,...$].filter(Boolean).join(`,
`))},"getInlineTableIndexes"),getIndexOptions:p,getIndexKeys:o}}});var Re=V((De,Ce)=>{"use strict";Ce.exports=m=>{let y=c((a,o)=>`${a}(${o})`,"addLength"),B=c((a,o)=>y(a,o),"addChildType"),O=c((a,o)=>`${a}(${o})`,"addPrecision"),E=c((a,o,p)=>m.isNumber(p)?`${a}(${o},${p})`:O(a,o),"addScalePrecision"),M=c((a,o,p)=>{let g=o?O(a,o):a;return p?`${g} WITH TIME ZONE`:g},"addTimezonePrecision"),b=c((a,o,p,g)=>{let R=a;return R+=o?`(${o})`:"",R+=p?` TO ${p}`:"",R+=g?`(${g})`:"",R},"addPrecisionAndToPrecision"),f=c(a=>["CHAR","CHARACTER","VARCHAR","CHAR VARYING","CHARACTER VARYING","VARGRAPHIC","CLOB","CHARACTER LARGE OBJECT","BYTE","VARBYTE","BLOB","ARRAY","JSON","XML","XMLTYPE","ST_GEOMETRY"].includes(a),"canHaveLength"),v=c(a=>["DECIMAL","DEC","NUMERIC","NUMBER"].includes(a),"canHavePrecisionAndScale"),_=c(a=>["INTERVAL YEAR","INTERVAL DAY","INTERVAL HOUR","INTERVAL MINUTE"].includes(a),"canHavePrecisionAndToPrecision"),K=c(a=>["INTERVAL SECOND"].includes(a),"canHavePrecisionAndSecondPrecision"),d=c(a=>["TIME","TIMESTAMP"].includes(a),"canHaveFractionalSecondPrecision"),A=c(a=>["PERIOD"].includes(a),"canHaveChildType"),u=c((a,o)=>{if(a=m.toUpper(a),A(a)){let p=u(o.childValueType,o);return B(a,p)}else{if(f(a)&&m.isNumber(o.length))return y(a,o.length);if(_(a))return b(a,o.precision,o.toPrecision,o.fractSecPrecision);if(K(a))return E(a,o.precision,o.fractSecPrecision);if(v(a)&&m.isNumber(o.precision))return E(a,o.precision,o.scale);if(d(a))return M(a,o.fractSecPrecision,o.timezone)}return a},"decorateType");return{decorateType:u}}});var C=te(),Ke=re(),Oe=se(),Me=oe(),ve=le();module.exports=(m,y,B)=>{let O=B.require("lodash"),{assignTemplates:E}=B.require("@hackolade/ddl-fe-utils"),{tab:M,commentIfDeactivated:b,checkAllKeysDeactivated:f,divideIntoActivatedAndDeactivated:v,hasType:_,clean:K,wrap:d,getDifferentProperties:A}=B.require("@hackolade/ddl-fe-utils").general,{generateConstraintsString:u,foreignKeysToString:a,foreignActiveKeysToString:o,createKeyConstraint:p}=me()({_:O,commentIfDeactivated:b,checkAllKeysDeactivated:f,divideIntoActivatedAndDeactivated:v,assignTemplates:E}),g=Ae()(O,K),{getTableName:R,getIndexName:w,getDatabaseOptions:j,getViewData:q,getJournalingStrategy:x,viewColumnsToString:Q,shouldDropDefaultJournalTable:z}=ue()(O,M,b),{getTableOptions:H,getUsingOptions:D,getInlineTableIndexes:i,getIndexOptions:l,getIndexKeys:N}=Se()({_:O,tab:M,getJournalingStrategy:x,commentIfDeactivated:b,checkAllKeysDeactivated:f,divideIntoActivatedAndDeactivated:v}),{decorateType:$}=Re()(O),U=Me(y.additionalOptions);return ve({commentIfDeactivated:b})(U.applyDropStatements,{hydrateDatabase(e){return{databaseName:e.name,isActivated:e.isActivated,db_account:e.db_account,db_default_map:e.db_default_map,db_permanent_storage_size:e.db_permanent_storage_size,spool_files_size:e.spool_files_size,has_fallback:e.has_fallback,db_before_journaling_strategy:e.db_before_journaling_strategy,db_after_journaling_strategy:e.db_after_journaling_strategy,db_default_journal_table:e.db_default_journal_table,db_default_journal_db:e.db_default_journal_db}},hydrateTable({tableData:e,entityData:t,jsonSchema:s}){let n=t[0],r=t[2].Indxs;return{...e,tableIndexes:r,keyConstraints:g.getTableKeyConstraints(s),tableOptions:n.tableOptions,partitioning:n.partitioning,selectStatement:n.selectStatement}},hydrateView({viewData:e,entityData:t}){let s=t[0];return{name:e.name,tableName:e.tableName,keys:e.keys,recursive:s.recursive,selectStatement:s.selectStatement}},hydrateIndex(e){return e},hydrateCheckConstraint(e){let t=c(s=>`CHECK (${O.trim(s).replace(/^\(([\s\S]*)\)$/,"$1")})`,"buildExpression");return{name:e.chkConstrName||"",expression:t(e.constrExpression)}},hydrateViewColumn(e){return{name:e.name,tableName:e.entityName,alias:e.alias,isActivated:e.isActivated,dbName:e.dbName}},hydrateColumn({columnDefinition:e,jsonSchema:t}){return{name:e.name,type:e.type,childValueType:t.childValueType,primaryKey:g.isInlinePrimaryKey(t),unique:g.isInlineUnique(t),isActivated:e.isActivated,length:e.length,inlineLength:t.inlineLength,storageFormat:t.storageFormat,withSchema:t.withSchema,precision:e.precision,scale:e.scale,required:!e.nullable,uppercase:t.uppercase,caseSpecific:t.caseSpecific,format:t.format,default:e.default,fractSecPrecision:t.fractSecPrecision,toPrecision:t.toPrecision,characterSet:t.characterSet,autoColumn:t.autoColumn,timezone:t.timezone,compress:t.compress,compressUsing:t.compressUsing,decompressUsing:t.decompressUsing,methodSpecification:t.methodSpecification}},createDatabase({databaseName:e,isActivated:t,db_account:s,db_default_map:n,db_permanent_storage_size:r,spool_files_size:T,has_fallback:I,db_before_journaling_strategy:L,db_after_journaling_strategy:S,db_default_journal_table:h,db_default_journal_db:P}){let F=j({db_account:s,db_default_map:n,db_permanent_storage_size:r,spool_files_size:T,has_fallback:I,db_before_journaling_strategy:L,db_after_journaling_strategy:S,db_default_journal_table:h,db_default_journal_db:P}),G=b(E(C.createDatabase,{name:e,databaseOptions:F}),{isActivated:t}),Y=E(C.createSession,{name:e});return[G,Y].join(`
`)},createUdt(e,t){let s=e.characterSet?` CHARACTER SET ${e.characterSet}`:"";if(e.type==="OBJECT"){if(O.isEmpty(e.properties))return"";let n=e.properties.map(r=>{let T=`"${r.name}" ${$(r.type,r)}`;return T+=r.characterSet?` CHARACTER SET ${r.characterSet}`:"",T}).join(`,
	`);return b(E(C.createStructuredType,{typeName:`"${e.name}"`,columnDefinitions:n,methodSpecification:e.methodSpecification?`
	${e.methodSpecification}`:""}),{isActivated:e.isActivated})}else if(e.type==="ARRAY"){if(O.isEmpty(e.items))return"";let n=O.first(e.items),r=$(n.type,n);return b(E(C.createArrayType,{typeName:`"${e.name}"`,baseType:`${r} ${$(e.type,e)}`,default:e.default?`
	DEFAULT ${e.default}`:""}),{isActivated:e.isActivated})}return b(E(C.createDistinctType,{typeName:`"${e.name}"`,baseType:$(e.type,e)+s,methodSpecification:e.methodSpecification?`
	${e.methodSpecification}`:""}),{isActivated:e.isActivated})},createTable(e,t){let{name:s,dbData:n,columns:r,checkConstraints:T,foreignKeyConstraints:I,selectStatement:L,tableOptions:S}=e,h=H(S),P=R(s,n.databaseName),F=i(e),G=S.TABLE_PRESERVATION?`
	ON COMMIT ${S.TABLE_PRESERVATION}`:"",Y=O.isEmpty(T)?"":`,
		`+T.join(`,
		`),X=v(e.keyConstraints.map(p(C,t)),J=>J.statement),k=u(X,t),W=v(I,J=>J.statement),Z=u(W,t);if(S.FOREIGN_TABLE&&S.USING?.location){let J=D(S.USING);return b(E(C.createForeignTable,{name:P,usingOptions:J,tableIndexes:F,tableOptions:h,column_definitions:r.join(`,
		`),keyConstraints:k,foreignKeyConstraints:Z,checkConstraints:Y,tablePreservation:G}),{isActivated:t})}return S.ERROR_TABLE&&S.FOR_TABLE?b(E(C.createErrorTable,{tableName:P,targetDataTable:S.FOR_TABLE}),{isActivated:t}):O.isEmpty(L)?b(E(C.createTable,{name:P,tableIndexes:F,tableOptions:h,tableSet:S.SET_MULTISET?` ${S.SET_MULTISET}`:"",temporary:S.TEMPORARY_VOLATILE?` ${S.TEMPORARY_VOLATILE}`:"",traceTable:S.TRACE_TABLE?" TRACE":"",column_definitions:r.join(`,
		`),keyConstraints:k,foreignKeyConstraints:Z,checkConstraints:Y,tablePreservation:G}),{isActivated:t}):b(E(C.createAsSelectTable,{tableSet:S.SET_MULTISET?` ${S.SET_MULTISET}`:"",temporary:S.TEMPORARY_VOLATILE?` ${S.TEMPORARY_VOLATILE}`:"",name:P,tableOptions:h,column_definitions:r.join(`,
		`),keyConstraints:k,foreignKeyConstraints:Z,checkConstraints:Y,selectStatement:L,tableIndexes:F,tablePreservation:G}),{isActivated:t})},createView(e,t,s){let{deactivatedWholeStatement:n,selectStatement:r}=this.viewSelectStatement(e,s);return b(E(C.createView,{name:R(e.name,t.databaseName),recursive:e.recursive?" RECURSIVE":"",selectStatement:r,columnList:Q(e.keys,s)}),{isActivated:!n})},viewSelectStatement(e,t=!0){let n=f(e.keys||[])||!t,{columns:r,tables:T}=q(e.keys),I=r.map(S=>S.statement).join(`,
		`);if(!n){let S=v(r,P=>P.statement),h=S.deactivatedItems.length?b(S.deactivatedItems.join(`,
		`),{isActivated:!1,isPartOfLine:!0}):"";I=S.activatedItems.join(`,
		`)+h}let L=O.trim(e.selectStatement)?O.trim(M(e.selectStatement)):E(C.viewSelectStatement,{tableName:T.join(", "),keys:I});return{deactivatedWholeStatement:n,selectStatement:L}},createIndex(e,t,s,n=!0){if(!["HASH","JOIN"].includes(t.indexType)||!t.indxName)return"";let T=l(t);if(t.indexType==="HASH"){if(O.isEmpty(t.indxKey))return"";let I=!O.isEmpty(t.orderKeys)&&!f(t.orderKeys||[]),L="";L+=t.orderBy?` ORDER BY ${t.orderBy}`:"",L+=!t.orderBy&&I?" ORDER BY":"",L+=I?` ( ${N(t.orderKeys)} )`:"";let S=f(t.indxKey||[]);return b(E(C.createHashIndex,{indexName:w(t.indxName,s.databaseName),tableName:R(e,s.databaseName),indexKeys:N(t.indxKey),orderBy:L,indexOptions:T}),{isActivated:n&&t.isActivated&&!S})}else if(t.indexType==="JOIN")return O.isEmpty(t.asSelect)?"":b(E(C.createJoinIndex,{indexName:w(t.indxName,s.databaseName),selectStatement:t.asSelect,indexOptions:T}),{isActivated:n&&t.isActivated});return""},createCheckConstraint(e){return E(C.checkConstraint,{name:e.name?`CONSTRAINT "${e.name}" `:"",expression:e.expression})},createCheckConstraintStatement(e,t,s){let n=R(e,s.databaseName);return E(C.alterTable,{tableName:n,tableOptions:"",alterStatement:E(C.addCheckConstraint,{name:d(t.name,'"','"'),expression:t.expression})})},dropCheckConstraint(e,t,s){let n=R(e,s.databaseName);return E(C.alterTable,{tableName:n,tableOptions:"",alterStatement:E(C.dropCheckConstraint,{name:d(t.name,'"','"')})})},alterCheckConstraint(e,{new:t,old:s},n){let r=R(e,n.databaseName),T=[];if(t.chkConstrName!==s.chkConstrName){let I=E(C.rename,{oldName:d(s.chkConstrName,'"','"'),newName:d(t.chkConstrName,'"','"')});T.push(I)}if(t.constrExpression!==s.constrExpression){let I=E(C.modifyCheckConstraint,{name:d(s.chkConstrName,'"','"'),expression:t.chkConstrName});T.push(I)}return E(C.alterTable,{tableName:r,tableOptions:"",alterStatement:`
`+M(T.join(`,
`))})},createForeignKeyConstraint({foreignKey:e,primaryTable:t,primaryKey:s,primaryTableActivated:n,foreignTableActivated:r,customProperties:T,isActivated:I},L){let S=f(s),h=f(e),P=!S&&!h&&n&&r&&I!==!1;return{statement:E(C.createForeignKeyConstraint,{checkOption:T.checkOption,primaryTable:R(t,L.databaseName),foreignKey:P?a(e):o(e),primaryKey:P?a(s):o(s)}),isActivated:P}},convertColumnDefinition(e){let t=this.hasType(e.type)?$(e.type,e):`"${e.type}"`,s=e.inlineLength?` INLINE LENGTH ${e.inlineLength}`:"",n=e.required?" NOT NULL":"",r=e.unique&&!e.nullable?" UNIQUE":"",T=e.primaryKey&&!e.nullable?" PRIMARY KEY":"",I=e.characterSet?` CHARACTER SET ${e.characterSet}`:"",L=e.storageFormat?` STORAGE FORMAT ${e.storageFormat}`:"",S=e.withSchema?` WITH SCHEMA ${e.withSchema}`:"",h=e.default?` DEFAULT ${e.default}`:"",P=e.uppercase?" UPPERCASE":"",F=e.caseSpecific?" CASESPECIFIC":"",G=e.format?` FORMAT '${e.format}'`:"",Y=e.autoColumn?" AUTO COLUMN":"",X=e.compress?` COMPRESS (${e.compress})`:"",k=e.compressUsing?` COMPRESS USING ${e.compressUsing}`:"",W=e.decompressUsing?` DECOMPRESS USING ${e.decompressUsing}`:"";return b(E(C.columnDefinition,{name:e.name,not_null:n,default:h,type:t,inlineLength:s,storageFormat:L,withSchema:S,uppercase:P,caseSpecific:F,format:G,autoColumn:Y,compress:X,compressUsing:k,decompressUsing:W,characterSet:I,inlineUniqueConstraint:r,inlinePKConstraint:T,inlineCheckConstraint:""}),{isActivated:e.isActivated})},hydrateDropDatabase(e){return{databaseName:e[0]?.name||""}},hydrateAlterDatabase({containerData:e,compModeData:t}){let s=e[0]||{},n=t.new.db_account!==t.old.db_account,r=t.new.db_default_map!==t.old.db_default_map,T=t.new.db_permanent_storage_size!==t.old.db_permanent_storage_size,I=t.new.spool_files_size!==t.old.spool_files_size,L=t.new.temporary_tables_size!==t.old.temporary_tables_size,S=t.new.has_fallback!==t.old.has_fallback,h=t.new.db_before_journaling_strategy!==t.old.db_before_journaling_strategy,P=t.new.db_after_journaling_strategy!==t.old.db_after_journaling_strategy,F=t.new.db_default_journal_db!==t.old.db_default_journal_db||t.new.db_default_journal_table!==t.old.db_default_journal_table,G=z(t);return{name:s.name||"",...n&&{db_account:s.db_account},...r&&{db_default_map:s.db_default_map},...T&&{db_permanent_storage_size:s.db_permanent_storage_size},...I&&{spool_files_size:s.spool_files_size},...L&&{temporary_tables_size:s.temporary_tables_size},...S&&{has_fallback:s.has_fallback},...h&&{db_before_journaling_strategy:s.db_before_journaling_strategy},...P&&{db_after_journaling_strategy:s.db_after_journaling_strategy},...F&&{db_default_journal_db:G?t.old.db_default_journal_db:s.db_default_journal_db,db_default_journal_table:G?t.old.db_default_journal_table:s.db_default_journal_table,dropDefaultJournalTable:G}}},hydrateDropTable({tableData:e,entityData:t}){let s=t[0];return{name:e.name,dbName:e.dbData.databaseName,temporary:s?.tableOptions?.TEMPORARY_VOLATILE==="GLOBAL TEMPORARY"}},hydrateAlterTable({name:e,newEntityData:t,oldEntityData:s}){let n=t[0]?.tableOptions||{},r=s[0]?.tableOptions||{},T=n.ERROR_TABLE!==r.ERROR_TABLE,I=n.FOR_TABLE!==r.FOR_TABLE,L=n.FOREIGN_TABLE!==r.FOREIGN_TABLE,S=n.SET_MULTISET!==r.SET_MULTISET,h=n.TEMPORARY_VOLATILE!==r.TEMPORARY_VOLATILE,P=n.QUEUE_TABLE!==r.QUEUE_TABLE,F=n.TRACE_TABLE!==r.TRACE_TABLE,G=n.EXTERNAL_SECURITY!==r.EXTERNAL_SECURITY,Y=n.AUTHORIZATION_NAME!==r.AUTHORIZATION_NAME,X=n.MAP!==r.MAP,k=n.COLOCATE_USING!==r.COLOCATE_USING,W=n.FALLBACK!==r.FALLBACK,Z=n.DEFAULT_JOURNAL_TABLE!==r.DEFAULT_JOURNAL_TABLE,J=n.LOG!==r.LOG,Ne=n.BEFORE_JOURNAL!==r.BEFORE_JOURNAL,Ie=n.AFTER_JOURNAL!==r.AFTER_JOURNAL,be=n.TABLE_CHECKSUM!==r.TABLE_CHECKSUM,ye=n.ISOLATED_LOADING!==r.ISOLATED_LOADING,fe=n.TABLE_PRESERVATION!==r.TABLE_PRESERVATION,Le=n.FREESPACE?.freeSpaceValue!==r.FREESPACE?.freeSpaceValue||n.FREESPACE?.percentUnit!==r.FREESPACE?.percentUnit,_e=n.MERGE_BLOCK_RATIO?.mergeRatio!==r.MERGE_BLOCK_RATIO?.mergeRatio||n.MERGE_BLOCK_RATIO?.specificRatio!==r.MERGE_BLOCK_RATIO?.specificRatio||n.MERGE_BLOCK_RATIO?.percentUnit!==r.MERGE_BLOCK_RATIO?.percentUnit,$e=n.DATA_BLOCK_SIZE.blockSize!==r.DATA_BLOCK_SIZE?.blockSize||n.DATA_BLOCK_SIZE?.specificSize!==r.DATA_BLOCK_SIZE?.specificSize||n.DATA_BLOCK_SIZE?.units!==r.DATA_BLOCK_SIZE?.units,ge=n.BLOCK_COMPRESSION?.blockCompressionType!==r.BLOCK_COMPRESSION?.blockCompressionType||n.BLOCK_COMPRESSION?.blockCompressionAlgorithm!==r.BLOCK_COMPRESSION?.blockCompressionAlgorithm||n.BLOCK_COMPRESSION?.blockCompressionLevel!==r.BLOCK_COMPRESSION?.blockCompressionLevel||n.BLOCK_COMPRESSION?.specificBlockCompressionLevel!==r.BLOCK_COMPRESSION?.specificBlockCompressionLevel,Be=n.USING?.location!==r.USING?.location||n.USING?.scanPercentage!==r.USING?.scanPercentage||n.USING?.pathPattern!==r.USING?.pathPattern||n.USING?.manifest!==r.USING?.manifest||n.USING?.tableFormat!==r.USING?.tableFormat||n.USING?.rowFormat!==r.USING?.rowFormat||n.USING?.storedAs!==r.USING?.storedAs||n.USING?.header!==r.USING?.header||n.USING?.stripSpaces!==r.USING?.stripSpaces||n.USING?.stripEnclosingChar!==r.USING?.stripEnclosingChar;return{name:e,tableOptions:{...T&&{ERROR_TABLE:n.ERROR_TABLE},...I&&{FOR_TABLE:n.FOR_TABLE},...L&&{FOREIGN_TABLE:n.FOREIGN_TABLE},...S&&{SET_MULTISET:n.SET_MULTISET},...h&&{TEMPORARY_VOLATILE:n.TEMPORARY_VOLATILE},...P&&{QUEUE_TABLE:n.QUEUE_TABLE},...F&&{TRACE_TABLE:n.TRACE_TABLE},...G&&{EXTERNAL_SECURITY:n.EXTERNAL_SECURITY},...Y&&{AUTHORIZATION_NAME:n.AUTHORIZATION_NAME},...X&&{MAP:n.MAP},...k&&{COLOCATE_USING:n.COLOCATE_USING},...W&&{FALLBACK:n.FALLBACK},...Z&&{DEFAULT_JOURNAL_TABLE:n.DEFAULT_JOURNAL_TABLE},...J&&{LOG:n.LOG},...Ne&&{BEFORE_JOURNAL:n.BEFORE_JOURNAL},...Ie&&{AFTER_JOURNAL:n.AFTER_JOURNAL},...be&&{TABLE_CHECKSUM:n.TABLE_CHECKSUM},...ye&&{ISOLATED_LOADING:n.ISOLATED_LOADING},...fe&&{TABLE_PRESERVATION:n.TABLE_PRESERVATION},...Le&&{FREESPACE:n.FREESPACE},..._e&&{MERGE_BLOCK_RATIO:n.MERGE_BLOCK_RATIO},...$e&&{DATA_BLOCK_SIZE:n.DATA_BLOCK_SIZE},...ge&&{BLOCK_COMPRESSION:n.BLOCK_COMPRESSION},...Be&&{USING:n.USING}}}},hydrateDropColumn({name:e}){return{name:e}},hydrateAlterColumn({newColumn:e,oldColumn:t,oldCompData:s,newCompData:n}){let r=A(e,t,["name","type"]),T={...e};return s.name!==n.name&&(T.oldName=s.name),s.type!==n.type&&(T.oldType=s.type),O.isEmpty(r)||(T.newOptions=r),T},hydrateDropView({tableData:e}){return{name:e.name,dbData:e.dbData}},hydrateAlterView({name:e,newEntityData:t,oldEntityData:s,viewData:n}){let r=this.hydrateView({viewData:{},entityData:t}),T=this.hydrateView({viewData:{},entityData:s}),I={};s[0]?.name!==t[0]?.name&&(I.oldName=s[0]?.name);let L=A(r,T);return{name:e,keys:n.keys,selectStatement:L.selectStatement||t[0]?.selectStatement,recursive:L.recursive||t[0]?.recursive,options:L,...I}},getDefaultType(e){return Ke[e]},getTypesDescriptors(){return Oe},hasType(e){return _(Oe,e)},dropDatabase(e){return E(C.dropDatabase,e)},alterDatabase(e){let t=j(e);return E(C.modifyDatabase,{databaseName:e.name,databaseOptions:t})},dropTable(e){return E(C.dropTable,{name:R(e.name,e.dbName),temporary:e.temporary?"TEMPORARY ":""})},alterTable(e,t){let s=R(e.name,t.databaseName),n=H(e.tableOptions,!0);return O.trim(n)?E(C.alterTable,{tableName:s,tableOptions:n}):""},dropColumn(e,t,s){let n=R(e,s.databaseName);return E(C.alterTable,{tableName:n,tableOptions:"",alterStatement:E(C.dropColumn,{name:d(t.name,'"','"')})})},addColumn(e,t,s){let n=R(e,s.databaseName);return E(C.alterTable,{tableName:n,tableOptions:"",alterStatement:E(C.addColumn,{columnDefinition:this.convertColumnDefinition(t)})})},renameColumn(e,t,s){let n=R(e,s.databaseName);return E(C.alterTable,{tableName:n,tableOptions:"",alterStatement:E(C.rename,{oldName:d(t.oldName,'"','"'),newName:d(t.name,'"','"')})})},alterColumn(e,t,s){let n=R(e,s.databaseName),r=[];if(t.oldName&&t.oldType||t.oldType){let T=this.dropColumn(e,{name:t.name},s),I=this.addColumn(e,{...t,isActivated:!0},s);r.push(T,I)}else if(t.oldName&&!t.newOptions){let T=this.renameColumn(e,t,s);r.push(T)}else if(t.oldName&&t.newOptions){let T=this.renameColumn(e,t,s),I=this.addColumn(e,{...t,isActivated:!0},s);r.push(T,I)}else{let T=this.addColumn(e,{...t,isActivated:!0},s);r.push(T)}return b(r.join(`

`),{isActivated:t.isActivated})},dropIndex(e,t,s){if(!t.indxName)return"";let n=R(e,s.databaseName);if(["PRIMARY","PRIMARY AMP"].includes(t.indexType))return"";if(!t.indexType||t.indexType==="SECONDARY")return E(C.dropSecondaryIndex,{indexName:d(t.indxName,'"','"'),tableName:n});let r=t.indexType?` ${t.indexType}`:"",T=w(t.indxName,s.databaseName);return E(C.dropIndex,{indexName:T,indexType:r})},alterIndex(e,{new:t,old:s},n){return[this.dropIndex(e,s,n),this.createIndex(e,{...t,indxKey:t.indxKey.filter(r=>r.isActivated!==!1)},n)].join(`

`)},dropView({name:e,dbData:t}){let s=R(e,t.databaseName);return E(C.dropView,{viewName:s})},alterView(e,t){let s=O.isEmpty(e.options),n=R(e.name,t.databaseName);if(e.oldName&&s){let r=R(e.oldName,t.databaseName);return E(C.renameView,{oldViewName:r,newViewName:n})}else if(s)return"";return[this.dropView({name:e.oldName||e.name,dbData:t}),this.createView(e,t,!0)].join(`

`)}})};
