"use strict";var Pe=Object.defineProperty;var c=(m,y)=>Pe(m,"name",{value:y,configurable:!0});var V=(m,y)=>()=>(y||m((y={exports:{}}).exports,y),y.exports);var te=V((Ge,ee)=>{"use strict";ee.exports={createDatabase:'CREATE DATABASE "${name}" AS ${databaseOptions};',createSession:'SET SESSION DATABASE "${name}";',columnDefinition:'"${name}" ${type}${inlineLength}${not_null}${uppercase}${caseSpecific}${format}${default}${storageFormat}${characterSet}${withSchema}${autoColumn}${compress}${compressUsing}${decompressUsing}${inlineCheckConstraint}${inlineUniqueConstraint}${inlinePKConstraint}',createTable:"CREATE${tableSet}${temporary}${traceTable} TABLE ${name}${tableOptions} (\n		${column_definitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n	)${tableIndexes}${tablePreservation};\n",createAsSelectTable:"CREATE${tableSet}${temporary} TABLE ${name}${tableOptions} (\n		${column_definitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n	)\n	AS (\n	${selectStatement} \n	)${tableIndexes}${tablePreservation};\n",createErrorTable:"CREATE ERROR TABLE ${tableName} FOR ${targetDataTable};\n",createForeignTable:"CREATE FOREIGN TABLE ${name}${tableOptions} (\n		${column_definitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n	)\n	USING (\n	${usingOptions}\n	)${tableIndexes}${tablePreservation};\n",createHashIndex:"CREATE HASH INDEX ${indexName}${indexOptions} (\n		${indexKeys}\n	)\n	ON ${tableName}${orderBy};\n",createJoinIndex:"CREATE JOIN INDEX ${indexName}${indexOptions}\n	AS ${selectStatement};\n",createKeyConstraint:"CONSTRAINT ${constraintName}${constraintType}${columns}",checkConstraint:"${name}${expression}",createForeignKeyConstraint:"FOREIGN KEY (${foreignKey}) REFERENCES ${checkOption} ${primaryTable} (${primaryKey})",createView:"CREATE${recursive} VIEW ${name} (\n	${columnList}\n)\nAS ${selectStatement};\n",viewSelectStatement:"SELECT ${keys}\n	FROM ${tableName}",createStructuredType:`CREATE TYPE \${typeName} AS (
	\${columnDefinitions}
)
NOT FINAL\${methodSpecification};
`,createDistinctType:"CREATE TYPE ${typeName} AS ${baseType} FINAL${methodSpecification};\n",createArrayType:"CREATE TYPE ${typeName} AS ${baseType}${default};\n",dropDatabase:'DROP DATABASE "${databaseName}";\n',modifyDatabase:'MODIFY DATABASE "${databaseName}" AS ${databaseOptions};\n',dropTable:"DROP ${temporary}TABLE ${name};\n",alterTable:"ALTER TABLE ${tableName}${tableOptions}${alterStatement};",addColumn:" ADD ${columnDefinition}",dropColumn:" DROP ${name}",rename:" RENAME ${oldName} TO ${newName}",dropCheckConstraint:" DROP CONSTRAINT ${name} CHECK",addCheckConstraint:" ADD CONSTRAINT ${name} ${expression}",modifyCheckConstraint:" MODIFY CONSTRAINT ${name} ${expression}",dropSecondaryIndex:"DROP INDEX ${indexName} ON ${tableName};",dropIndex:"DROP${indexType} INDEX ${indexName};",dropView:"DROP VIEW ${viewName};",renameView:"RENAME VIEW ${oldViewName} TO ${newViewName};"}});var re=V((xe,ne)=>{"use strict";ne.exports={number:"NUMBER",string:"TEXT",date:"DATE",timestamp:"TIMESTAMP",binary:"BYTE",boolean:"NUMBER",document:"OBJECT",array:"ARRAY",objectId:"VARCHAR(24)",default:"CHAR"}});var se=V((Ve,ae)=>{"use strict";ae.exports={BYTEINT:{capacity:1},SMALLINT:{capacity:2},INT:{capacity:4},INTEGER:{capacity:4},BIGINT:{capacity:8},DECIMAL:{mode:"decimal"},DEC:{mode:"decimal"},NUMERIC:{mode:"decimal"},FLOAT:{capacity:4,mode:"float"},"DOUBLE PRECISION":{capacity:8,mode:"float"},REAL:{capacity:8,mode:"float"},NUMBER:{mode:"number"},CHAR:{mode:"char"},CHARACTER:{mode:"char"},VARCHAR:{mode:"varchar"},"CHAR VARYING":{mode:"varchar"},"CHARACTER VARYING":{mode:"varchar"},"LONG VARCHAR":{mode:"long varchar"},VARGRAPHIC:{mode:"vargraphic"},"LONG VARGRAPHIC":{mode:"long vargraphic"},CLOB:{mode:"clob"},"CHARACTER LARGE OBJECT":{mode:"clob"},BYTE:{mode:"byte"},VARBYTE:{mode:"varbyte"},BLOB:{mode:"blob"},DATE:{format:"YYYY-MM-DD"},TIME:{format:"hh:mm:ss"},TIMESTAMP:{format:"YYYY-MM-DD hh:mm:ss"},ST_Geometry:{mode:"ST_Geometry"},MBR:{mode:"MBR"},MBB:{mode:"MBB"},JSON:{},XML:{},XMLTYPE:{},DATASET:{},PERIOD:{},"INTERVAL YEAR":{},"INTERVAL MONTH":{},"INTERVAL DAY":{},"INTERVAL HOUR":{},"INTERVAL MINUTE":{},"INTERVAL SECOND":{}}});var oe=V((Ye,ie)=>{"use strict";var Ue=c(m=>Array.isArray(m)?m.reduce((y,B)=>({...y,[B.id]:B.value}),{}):{},"getAdditionalOptions");ie.exports=Ue});var le=V((He,ce)=>{"use strict";var Ke=c(({commentIfDeactivated:m})=>(y,B)=>{let O=!1;return{...B,...["dropDatabase","dropTable","dropColumn","dropIndex","dropCheckConstraint","dropView"].reduce((E,M)=>({...E,[M]:(...b)=>{let f=B[M](...b);return O=O||!!f,y||!f?f:m(f,{isActivated:!1})}}),{}),isDropInStatements(){return O}}},"dropStatementProxy");ce.exports=Ke});var me=V((Je,de)=>{"use strict";de.exports=({_:m,commentIfDeactivated:y,checkAllKeysDeactivated:B,divideIntoActivatedAndDeactivated:O,assignTemplates:E})=>({generateConstraintsString:c((_,h)=>{let d=y((_?.deactivatedItems||[]).join(`,
		`),{isActivated:!h,isPartOfLine:!0}),A=_?.activatedItems?.length?`,
		`+_.activatedItems.join(`,
		`):"",u=_?.deactivatedItems?.length?`
		`+d:"";return A+u},"generateConstraintsString"),foreignKeysToString:c(_=>{if(Array.isArray(_)){let h=_.filter(u=>m.get(u,"isActivated",!0)).map(u=>`"${m.trim(u.name)}"`),d=_.filter(u=>!m.get(u,"isActivated",!0)).map(u=>`"${m.trim(u.name)}"`),A=d.length?y(d,{isActivated:!1,isPartOfLine:!0}):"";return h.join(", ")+A}return _},"foreignKeysToString"),foreignActiveKeysToString:c(_=>_.map(h=>m.trim(h.name)).join(", "),"foreignActiveKeysToString"),createKeyConstraint:c((_,h)=>d=>{let A=c(({name:g})=>`"${g}"`,"columnMapToString"),u=B(d.columns),r=O(d.columns,A),o=r?.deactivatedItems?.length?y(r.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"",p=!u&&h?" ("+r.activatedItems.join(", ")+o+")":" ("+d.columns.map(A).join(", ")+")";return{statement:E(_.createKeyConstraint,{constraintName:d.name?`"${m.trim(d.name)}" `:"",constraintType:d.keyType,columns:p}),isActivated:!u}},"createKeyConstraint")})});var Ae=V((qe,Ee)=>{"use strict";Ee.exports=(m,y)=>{let B=c((r,o)=>Object.entries(r.properties).map(o),"mapProperties"),O=c(r=>r.compositeUniqueKey?!1:!!r.unique,"isUniqueKey"),E=c(r=>r.compositeUniqueKey||r.compositePrimaryKey?!1:!!r.primaryKey,"isPrimaryKey"),M=c(r=>O(r)&&m.isEmpty(r.uniqueKeyConstraintName),"isInlineUnique"),b=c(r=>E(r)&&m.isEmpty(r.primaryKeyConstraintName),"isInlinePrimaryKey"),f=c((r,o,p,g)=>y({keyType:o,name:r,columns:[{name:p,isActivated:g}]}),"hydrateKeyConstraintOptions"),v=c((r,o)=>Object.keys(o).find(p=>o[p].GUID===r),"findName"),_=c((r,o)=>m.get(Object.values(o).find(p=>p.GUID===r),"isActivated",!0),"checkIfActivated"),h=c((r,o)=>m.map(r,p=>({name:v(p.keyId,o.properties),isActivated:_(p.keyId,o.properties)})),"getKeys"),d=c(r=>Array.isArray(r.primaryKey)?r.primaryKey.filter(o=>!m.isEmpty(o.compositePrimaryKey)).map(o=>({...f(o.constraintName,"PRIMARY KEY",null,r),columns:h(o.compositePrimaryKey,r)})):[],"getCompositePrimaryKeys"),A=c(r=>Array.isArray(r.uniqueKey)?r.uniqueKey.filter(o=>!m.isEmpty(o.compositeUniqueKey)).map(o=>({...f(o.constraintName,"UNIQUE",null,r),columns:h(o.compositeUniqueKey,r)})):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:c(r=>{if(!r.properties)return[];let o=B(r,([g,R])=>{if(E(R)){if(m.isEmpty(R.primaryKeyConstraintName))return}else return;return f(R.primaryKeyConstraintName,"PRIMARY KEY",g,R.isActivated,r)}).filter(Boolean),p=m.flatten(B(r,([g,R])=>{if(O(R)){if(m.isEmpty(R.uniqueKeyConstraintName))return}else return;return f(R.uniqueKeyConstraintName,"UNIQUE",g,R.isActivated,r)})).filter(Boolean);return[...o,...d(r),...p,...A(r)]},"getTableKeyConstraints"),isInlineUnique:M,isInlinePrimaryKey:b}}});var ue=V((Xe,Te)=>{"use strict";Te.exports=(m,y,B)=>{let O=c((A,u)=>{if(!u)return A.map(p=>`"${p.name}"`).join(`,
	`);let r=A.filter(p=>p.isActivated).map(p=>`"${p.name}"`),o=A.filter(p=>!p.isActivated).map(p=>`"${p.name}"`);return r.length===0?B(o.join(`,
	`),{isActivated:!1},!0):o.length===0?r.join(`,
	`):r.join(`,
	`)+`
	`+B(o.join(`,
	`),{isActivated:!1},!0)},"viewColumnsToString"),E=c((A,u)=>u?`"${u}"."${A}"`:`"${A}"`,"getTableName"),M=E,b=c((A,u)=>A?`"${A}"."${u}"`:u,"getDefaultJournalTableName"),f=c((A,u)=>A===u?`${u} JOURNAL`:`${A} ${u} JOURNAL`,"getJournalingStrategy"),v=c(({db_account:A,db_default_map:u,db_permanent_storage_size:r,spool_files_size:o,has_fallback:p,db_before_journaling_strategy:g,db_after_journaling_strategy:R,db_default_journal_table:w,db_default_journal_db:j,dropDefaultJournalTable:q})=>{let x=c((H,D,i=!1)=>l=>H?[...l,D]:i?[...l,i]:l,"add"),z=`${q?"DROP ":""}DEFAULT JOURNAL TABLE = ${b(j,w)}`;return m.flow([x(r,`PERMANENT = ${r}`),x(o,`SPOOL = ${o}`),x(A,`ACCOUNT = ${A}`),x(u,`DEFAULT MAP = ${u}`),x(p,"FALLBACK","NO FALLBACK"),x(g,f(g,"BEFORE")),x(R,f(R,"AFTER")),x(w,z),H=>y(`
 `+H.join(`,
 `))])([])},"getDatabaseOptions"),_=c(A=>A?A.alias?`"${A.name}" AS "${A.alias}"`:`"${A.name}"`:"","getKeyWithAlias");return{getTableName:E,getIndexName:M,getJournalingStrategy:f,getDefaultJournalTableName:b,getDatabaseOptions:v,getViewData:c(A=>Array.isArray(A)?A.reduce((u,r)=>{if(!r.tableName)return u.columns.push(_(r)),u;let o=`"${r.dbName}"."${r.tableName}"`;return u.tables.includes(o)||u.tables.push(o),u.columns.push({statement:`${o}.${_(r)}`,isActivated:r.isActivated}),u},{tables:[],columns:[]}):{tables:[],columns:[]},"getViewData"),viewColumnsToString:O,shouldDropDefaultJournalTable:c(A=>!!(A.old.db_default_journal_db&&A.old.db_default_journal_table&&!A.new.db_default_journal_db&&!A.new.db_default_journal_table),"shouldDropDefaultJournalTable")}}});var Ce=V((Ze,pe)=>{"use strict";pe.exports=({_:m,tab:y,getJournalingStrategy:B,commentIfDeactivated:O,divideIntoActivatedAndDeactivated:E})=>{let M=c(i=>i?.percentUnit?`${i.freeSpaceValue} PERCENT`:i?.freeSpaceValue||"","getFreeSpaceValue"),b=c((i={})=>{if(i.mergeRatio==="SPECIFIC"&&i.specificRatio){let l=i.percentUnit?"PERCENT":"";return`MERGEBLOCKRATIO = ${i.specificRatio} ${l}`}return`${i.mergeRatio} MERGEBLOCKRATIO`},"getMergeBlockRatio"),f=c((i={})=>{if(i.blockSize==="SPECIFIC"&&i.specificSize){let l=i.units?` ${i.units}`:"";return i.blockSize+l}return`${i.blockSize} DATABLOCKSIZE`},"getDataBlockSize"),v=c((i,l)=>i==="SPECIFIC"&&l?`BLOCKCOMPRESSIONLEVEL = ${l}`:`BLOCKCOMPRESSIONLEVEL = ${i}`,"getBlockCompressionLevel"),_=c((i={})=>m.flow([d(!!i.blockCompressionType,`BLOCKCOMPRESSION = ${i.blockCompressionType}`),d(!!i.blockCompressionType,`BLOCKCOMPRESSIONALGORITHM = ${i.blockCompressionAlgorithm}`),d(!!i.blockCompressionLevel,v(i.blockCompressionLevel,i.specificBlockCompressionLevel))])([]),"getBlockCompression"),h=c(i=>["NO","CONCURRENT"].includes(i)?`WITH ${i} ISOLATED LOADING`:`WITH ISOLATED LOADING ${i}`,"getIsolatedLoading"),d=c((i,l,N=!1)=>$=>i?m.flatten([...$,l]):N?[...$,N]:$,"add"),A=c(i=>{let l=y(i.join(`,
`));return m.isEmpty(i)?l:`,
`+l},"formatTableOptions"),u=c(({FALLBACK:i,BEFORE_JOURNAL:l,AFTER_JOURNAL:N,DEFAULT_JOURNAL_TABLE:$,FREESPACE:U,TABLE_CHECKSUM:e,LOG:t,MAP:s,COLOCATE_USING:n,ISOLATED_LOADING:a,MERGE_BLOCK_RATIO:T,DATA_BLOCK_SIZE:I,BLOCK_COMPRESSION:L,QUEUE_TABLE:C,EXTERNAL_SECURITY:K,AUTHORIZATION_NAME:P},F=!1)=>m.flow([d(C,"QUEUE"),d(!!s,`MAP = ${s}${n?` COLOCATE USING ${n}`:""}`),d(i,"FALLBACK",F?"":"NO FALLBACK"),d(!!$,`WITH JOURNAL TABLE = ${$}`),d(t,"LOG",F?"":"NO LOG"),d(!!l,B(l,"BEFORE")),d(!!N,B(l,"AFTER")),d(!!e,`CHECKSUM = ${e}`),d(!!U?.freeSpaceValue,`FREESPACE = ${M(U)}`),d(!!T?.mergeRatio,b(T)),d(!!I?.blockSize,f(I)),d(!!L?.blockCompressionType,_(L)),d(!!a,h(a)),d(!!K,`EXTERNAL SECURITY ${K} TRUSTED${P?" "+P:""}`),A])([]),"getTableOptions"),r=c((i,l)=>{let N="";return N+=l?" ":"",N+=!i||i==="SECONDARY"?"INDEX":`${i} INDEX`,N},"getIndexType"),o=c((i=[])=>{if(m.isEmpty(i))return"";let l=E(i,$=>`"${$.name}"`);if(m.isEmpty(l.activatedItems))return l.deactivatedItems.join(", ");let N=l.deactivatedItems.length?O(l.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"";return l.activatedItems.join(", ")+N},"getIndexKeys"),p=c(({indexMap:i,colocateUsing:l,indexFallback:N,checksum:$,blockCompression:U})=>m.flow([d(i,`MAP = ${i}${l?` COLOCATE USING ${l}`:""}`),d(N,"FALLBACK","NO FALLBACK"),d($,`CHECKSUM = ${$}`),d(U,`BLOCKCOMPRESSION = ${U}`),A])([]),"getIndexOptions"),g=c(({isActivated:i,unique:l,indexType:N,all:$,indxKey:U,indxName:e,orderBy:t,orderKeys:s,loadIdentity:n})=>{if(m.isEmpty(U))return"";let a="";return a+=l?"UNIQUE":"",a+=r(N,l),a+=e?` "${e}"`:"",a+=$?" ALL":"",a+=m.isEmpty(U)?"":` ( ${o(U)} )`,a+=t?` ORDER BY ${t}`:"",a+=m.isEmpty(s)?"":` ( ${o(s)} )`,a+=n?` ${n}`:"",O(a,{isActivated:i})},"getTableInlineIndexStatement"),R=c(i=>i.map(g),"getTableInlineIndexStatements"),w=c(i=>{let l=i.find(N=>["PRIMARY","PRIMARY AMP"].includes(N.indexType)&&!m.isEmpty(N.indxKey));return l||{}},"findPrimaryIndex"),j=c(i=>i.filter(l=>(!l.indexType||l.indexType==="SECONDARY")&&!m.isEmpty(l.indxKey)),"filterSecondaryIndexes"),q=m.flow([w,g]),x=m.flow([j,R,m.compact]),Q=c(i=>i.map(l=>{let N="";return N+=l.columnFormat?l.columnFormat:"",N+=l.name&&l.columnFormat?` "${l.name}"`:`"${l.name}"`,N+=l.autoCompression?` ${l.autoCompression}`:"",N}),"getPartitionKeys"),z=c((i={})=>{let l="PARTITION BY";return l+=i.partitionBy==="column"?" COLUMN":"",l+=i.partitioningExpression?` ${i.partitioningExpression}`:"",l+=i.compositePartitionKey?` (
	${Q(i.compositePartitionKey).join(`,
	`)}
)`:"",l},"getPartitions");return{getTableOptions:u,getUsingOptions:c(({location:i,scanPercentage:l,pathPattern:N,manifest:$,tableFormat:U,rowFormat:e,storedAs:t,header:s,stripSpaces:n,stripEnclosingChar:a})=>m.flow([d(i,`LOCATION ( '${i}' )`),d(l,`SCANPCT = '${l}'`),d(N,`PATHPATTERN ( '${N}' )`),d($,"MANIFEST ( 'TRUE' )","MANIFEST ( 'FALSE' )"),d(U,`TABLE_FORMAT ( '${U}' )`),d(e,`ROWFORMAT ( '${e}' )`),d(t,`STOREDAS ( '${t}' )`),d(s,"HEADER ( 'TRUE' )","STRIP_EXTERIOR_SPACES ( 'FALSE' )"),d(n,"STRIP_EXTERIOR_SPACES ( 'TRUE' )","STRIP_EXTERIOR_SPACES ( 'FALSE' )"),d(a,`STRIP_ENCLOSING_CHAR ( '${a}' )`),T=>y(T.join(`
	`))])([]),"getUsingOptions"),getInlineTableIndexes:c(i=>{let l=q(i.tableIndexes||[]),N=m.isEmpty(i.partitioning.partitioningExpression)&&m.isEmpty(i.partitioning.compositePartitionKey)?"":z(i.partitioning),$=x(i.tableIndexes||[]);if(!l&&!N&&m.isEmpty($))return"";let U="";return U+=l||"",U+=N?`
`+N:"",`
`+y([U,...$].filter(Boolean).join(`,
`))},"getInlineTableIndexes"),getIndexOptions:p,getIndexKeys:o}}});var Re=V((De,Se)=>{"use strict";Se.exports=m=>{let y=c((r,o)=>`${r}(${o})`,"addLength"),B=c((r,o)=>y(r,o),"addChildType"),O=c((r,o)=>`${r}(${o})`,"addPrecision"),E=c((r,o,p)=>m.isNumber(p)?`${r}(${o},${p})`:O(r,o),"addScalePrecision"),M=c((r,o,p)=>{let g=o?O(r,o):r;return p?`${g} WITH TIME ZONE`:g},"addTimezonePrecision"),b=c((r,o,p,g)=>{let R=r;return R+=o?`(${o})`:"",R+=p?` TO ${p}`:"",R+=g?`(${g})`:"",R},"addPrecisionAndToPrecision"),f=c(r=>["CHAR","CHARACTER","VARCHAR","CHAR VARYING","CHARACTER VARYING","VARGRAPHIC","CLOB","CHARACTER LARGE OBJECT","BYTE","VARBYTE","BLOB","ARRAY","JSON","XML","XMLTYPE","ST_GEOMETRY"].includes(r),"canHaveLength"),v=c(r=>["DECIMAL","DEC","NUMERIC","NUMBER"].includes(r),"canHavePrecisionAndScale"),_=c(r=>["INTERVAL YEAR","INTERVAL DAY","INTERVAL HOUR","INTERVAL MINUTE"].includes(r),"canHavePrecisionAndToPrecision"),h=c(r=>["INTERVAL SECOND"].includes(r),"canHavePrecisionAndSecondPrecision"),d=c(r=>["TIME","TIMESTAMP"].includes(r),"canHaveFractionalSecondPrecision"),A=c(r=>["PERIOD"].includes(r),"canHaveChildType"),u=c((r,o)=>{if(r=m.toUpper(r),A(r)){let p=u(o.childValueType,o);return B(r,p)}else{if(f(r)&&m.isNumber(o.length))return y(r,o.length);if(_(r))return b(r,o.precision,o.toPrecision,o.fractSecPrecision);if(h(r))return E(r,o.precision,o.fractSecPrecision);if(v(r)&&m.isNumber(o.precision))return E(r,o.precision,o.scale);if(d(r))return M(r,o.fractSecPrecision,o.timezone)}return r},"decorateType");return{decorateType:u}}});var S=te(),he=re(),Oe=se(),Me=oe(),ve=le();module.exports=(m,y,B)=>{let O=B.require("lodash"),{assignTemplates:E}=B.require("@hackolade/ddl-fe-utils"),{tab:M,commentIfDeactivated:b,checkAllKeysDeactivated:f,divideIntoActivatedAndDeactivated:v,hasType:_,clean:h,wrap:d,getDifferentProperties:A}=B.require("@hackolade/ddl-fe-utils").general,{generateConstraintsString:u,foreignKeysToString:r,foreignActiveKeysToString:o,createKeyConstraint:p}=me()({_:O,commentIfDeactivated:b,checkAllKeysDeactivated:f,divideIntoActivatedAndDeactivated:v,assignTemplates:E}),g=Ae()(O,h),{getTableName:R,getIndexName:w,getDatabaseOptions:j,getViewData:q,getJournalingStrategy:x,viewColumnsToString:Q,shouldDropDefaultJournalTable:z}=ue()(O,M,b),{getTableOptions:H,getUsingOptions:D,getInlineTableIndexes:i,getIndexOptions:l,getIndexKeys:N}=Ce()({_:O,tab:M,getJournalingStrategy:x,commentIfDeactivated:b,checkAllKeysDeactivated:f,divideIntoActivatedAndDeactivated:v}),{decorateType:$}=Re()(O),U=Me(y.additionalOptions);return ve({commentIfDeactivated:b})(U.applyDropStatements,{hydrateDatabase(e){return{databaseName:e.name,isActivated:e.isActivated,db_account:e.db_account,db_default_map:e.db_default_map,db_permanent_storage_size:e.db_permanent_storage_size,spool_files_size:e.spool_files_size,has_fallback:e.has_fallback,db_before_journaling_strategy:e.db_before_journaling_strategy,db_after_journaling_strategy:e.db_after_journaling_strategy,db_default_journal_table:e.db_default_journal_table,db_default_journal_db:e.db_default_journal_db}},hydrateTable({tableData:e,entityData:t,jsonSchema:s}){let n=t[0],a=t[2].Indxs;return{...e,tableIndexes:a,keyConstraints:g.getTableKeyConstraints(s),tableOptions:n.tableOptions,partitioning:n.partitioning,selectStatement:n.selectStatement}},hydrateView({viewData:e,entityData:t}){let s=t[0];return{name:e.name,tableName:e.tableName,keys:e.keys,recursive:s.recursive,selectStatement:s.selectStatement}},hydrateIndex(e){return e},hydrateCheckConstraint(e){let t=c(s=>`CHECK (${O.trim(s).replace(/^\(([\s\S]*)\)$/,"$1")})`,"buildExpression");return{name:e.chkConstrName||"",expression:t(e.constrExpression)}},hydrateViewColumn(e){return{name:e.name,tableName:e.entityName,alias:e.alias,isActivated:e.isActivated,dbName:e.dbName}},hydrateColumn({columnDefinition:e,jsonSchema:t}){return{name:e.name,type:e.type,childValueType:t.childValueType,primaryKey:g.isInlinePrimaryKey(t),unique:g.isInlineUnique(t),isActivated:e.isActivated,length:e.length,inlineLength:t.inlineLength,storageFormat:t.storageFormat,withSchema:t.withSchema,precision:e.precision,scale:e.scale,required:!e.nullable,uppercase:t.uppercase,caseSpecific:t.caseSpecific,format:t.format,default:e.default,fractSecPrecision:t.fractSecPrecision,toPrecision:t.toPrecision,characterSet:t.characterSet,autoColumn:t.autoColumn,timezone:t.timezone,compress:t.compress,compressUsing:t.compressUsing,decompressUsing:t.decompressUsing,methodSpecification:t.methodSpecification}},createDatabase({databaseName:e,isActivated:t,db_account:s,db_default_map:n,db_permanent_storage_size:a,spool_files_size:T,has_fallback:I,db_before_journaling_strategy:L,db_after_journaling_strategy:C,db_default_journal_table:K,db_default_journal_db:P}){let F=j({db_account:s,db_default_map:n,db_permanent_storage_size:a,spool_files_size:T,has_fallback:I,db_before_journaling_strategy:L,db_after_journaling_strategy:C,db_default_journal_table:K,db_default_journal_db:P}),G=b(E(S.createDatabase,{name:e,databaseOptions:F}),{isActivated:t}),Y=E(S.createSession,{name:e});return[G,Y].join(`
`)},createUdt(e,t){let s=e.characterSet?` CHARACTER SET ${e.characterSet}`:"";if(e.type==="OBJECT"){if(O.isEmpty(e.properties))return"";let n=e.properties.map(a=>{let T=`"${a.name}" ${$(a.type,a)}`;return T+=a.characterSet?` CHARACTER SET ${a.characterSet}`:"",T}).join(`,
	`);return b(E(S.createStructuredType,{typeName:`"${e.name}"`,columnDefinitions:n,methodSpecification:e.methodSpecification?`
	${e.methodSpecification}`:""}),{isActivated:e.isActivated})}else if(e.type==="ARRAY"){if(O.isEmpty(e.items))return"";let n=O.first(e.items),a=$(n.type,n);return b(E(S.createArrayType,{typeName:`"${e.name}"`,baseType:`${a} ${$(e.type,e)}`,default:e.default?`
	DEFAULT ${e.default}`:""}),{isActivated:e.isActivated})}return b(E(S.createDistinctType,{typeName:`"${e.name}"`,baseType:$(e.type,e)+s,methodSpecification:e.methodSpecification?`
	${e.methodSpecification}`:""}),{isActivated:e.isActivated})},createTable(e,t){let{name:s,dbData:n,columns:a,checkConstraints:T,foreignKeyConstraints:I,selectStatement:L,tableOptions:C}=e,K=H(C),P=R(s,n.databaseName),F=i(e),G=C.TABLE_PRESERVATION?`
	ON COMMIT ${C.TABLE_PRESERVATION}`:"",Y=O.isEmpty(T)?"":`,
		`+T.join(`,
		`),X=v(e.keyConstraints.map(p(S,t)),J=>J.statement),k=u(X,t),W=v(I,J=>J.statement),Z=u(W,t);if(C.FOREIGN_TABLE&&C.USING?.location){let J=D(C.USING);return b(E(S.createForeignTable,{name:P,usingOptions:J,tableIndexes:F,tableOptions:K,column_definitions:a.join(`,
		`),keyConstraints:k,foreignKeyConstraints:Z,checkConstraints:Y,tablePreservation:G}),{isActivated:t})}return C.ERROR_TABLE&&C.FOR_TABLE?b(E(S.createErrorTable,{tableName:P,targetDataTable:C.FOR_TABLE}),{isActivated:t}):O.isEmpty(L)?b(E(S.createTable,{name:P,tableIndexes:F,tableOptions:K,tableSet:C.SET_MULTISET?` ${C.SET_MULTISET}`:"",temporary:C.TEMPORARY_VOLATILE?` ${C.TEMPORARY_VOLATILE}`:"",traceTable:C.TRACE_TABLE?" TRACE":"",column_definitions:a.join(`,
		`),keyConstraints:k,foreignKeyConstraints:Z,checkConstraints:Y,tablePreservation:G}),{isActivated:t}):b(E(S.createAsSelectTable,{tableSet:C.SET_MULTISET?` ${C.SET_MULTISET}`:"",temporary:C.TEMPORARY_VOLATILE?` ${C.TEMPORARY_VOLATILE}`:"",name:P,tableOptions:K,column_definitions:a.join(`,
		`),keyConstraints:k,foreignKeyConstraints:Z,checkConstraints:Y,selectStatement:L,tableIndexes:F,tablePreservation:G}),{isActivated:t})},createView(e,t,s){let{deactivatedWholeStatement:n,selectStatement:a}=this.viewSelectStatement(e,s);return b(E(S.createView,{name:R(e.name,t.databaseName),recursive:e.recursive?" RECURSIVE":"",selectStatement:a,columnList:Q(e.keys,s)}),{isActivated:!n})},viewSelectStatement(e,t=!0){let n=f(e.keys||[])||!t,{columns:a,tables:T}=q(e.keys),I=a.map(C=>C.statement).join(`,
		`);if(!n){let C=v(a,P=>P.statement),K=C.deactivatedItems.length?b(C.deactivatedItems.join(`,
		`),{isActivated:!1,isPartOfLine:!0}):"";I=C.activatedItems.join(`,
		`)+K}let L=O.trim(e.selectStatement)?O.trim(M(e.selectStatement)):E(S.viewSelectStatement,{tableName:T.join(", "),keys:I});return{deactivatedWholeStatement:n,selectStatement:L}},createIndex(e,t,s,n=!0){if(!["HASH","JOIN"].includes(t.indexType)||!t.indxName)return"";let T=l(t);if(t.indexType==="HASH"){if(O.isEmpty(t.indxKey))return"";let I=!O.isEmpty(t.orderKeys)&&!f(t.orderKeys||[]),L="";L+=t.orderBy?` ORDER BY ${t.orderBy}`:"",L+=!t.orderBy&&I?" ORDER BY":"",L+=I?` ( ${N(t.orderKeys)} )`:"";let C=f(t.indxKey||[]);return b(E(S.createHashIndex,{indexName:w(t.indxName,s.databaseName),tableName:R(e,s.databaseName),indexKeys:N(t.indxKey),orderBy:L,indexOptions:T}),{isActivated:n&&t.isActivated&&!C})}else if(t.indexType==="JOIN")return O.isEmpty(t.asSelect)?"":b(E(S.createJoinIndex,{indexName:w(t.indxName,s.databaseName),selectStatement:t.asSelect,indexOptions:T}),{isActivated:n&&t.isActivated});return""},createCheckConstraint(e){return E(S.checkConstraint,{name:e.name?`CONSTRAINT "${e.name}" `:"",expression:e.expression})},createCheckConstraintStatement(e,t,s){let n=R(e,s.databaseName);return E(S.alterTable,{tableName:n,tableOptions:"",alterStatement:E(S.addCheckConstraint,{name:d(t.name,'"','"'),expression:t.expression})})},dropCheckConstraint(e,t,s){let n=R(e,s.databaseName);return E(S.alterTable,{tableName:n,tableOptions:"",alterStatement:E(S.dropCheckConstraint,{name:d(t.name,'"','"')})})},alterCheckConstraint(e,{new:t,old:s},n){let a=R(e,n.databaseName),T=[];if(t.chkConstrName!==s.chkConstrName){let I=E(S.rename,{oldName:d(s.chkConstrName,'"','"'),newName:d(t.chkConstrName,'"','"')});T.push(I)}if(t.constrExpression!==s.constrExpression){let I=E(S.modifyCheckConstraint,{name:d(s.chkConstrName,'"','"'),expression:t.chkConstrName});T.push(I)}return E(S.alterTable,{tableName:a,tableOptions:"",alterStatement:`
`+M(T.join(`,
`))})},createForeignKeyConstraint({foreignKey:e,primaryTable:t,primaryKey:s,primaryTableActivated:n,foreignTableActivated:a,customProperties:T,isActivated:I},L){let C=f(s),K=f(e),P=!C&&!K&&n&&a&&I!==!1;return{statement:E(S.createForeignKeyConstraint,{checkOption:T.checkOption,primaryTable:R(t,L.databaseName),foreignKey:P?r(e):o(e),primaryKey:P?r(s):o(s)}),isActivated:P}},convertColumnDefinition(e){let t=this.hasType(e.type)?$(e.type,e):`"${e.type}"`,s=e.inlineLength?` INLINE LENGTH ${e.inlineLength}`:"",n=e.required?" NOT NULL":"",a=e.unique&&!e.nullable?" UNIQUE":"",T=e.primaryKey&&!e.nullable?" PRIMARY KEY":"",I=e.characterSet?` CHARACTER SET ${e.characterSet}`:"",L=e.storageFormat?` STORAGE FORMAT ${e.storageFormat}`:"",C=e.withSchema?` WITH SCHEMA ${e.withSchema}`:"",K=e.default?` DEFAULT ${e.default}`:"",P=e.uppercase?" UPPERCASE":"",F=e.caseSpecific?" CASESPECIFIC":"",G=e.format?` FORMAT '${e.format}'`:"",Y=e.autoColumn?" AUTO COLUMN":"",X=e.compress?` COMPRESS (${e.compress})`:"",k=e.compressUsing?` COMPRESS USING ${e.compressUsing}`:"",W=e.decompressUsing?` DECOMPRESS USING ${e.decompressUsing}`:"";return b(E(S.columnDefinition,{name:e.name,not_null:n,default:K,type:t,inlineLength:s,storageFormat:L,withSchema:C,uppercase:P,caseSpecific:F,format:G,autoColumn:Y,compress:X,compressUsing:k,decompressUsing:W,characterSet:I,inlineUniqueConstraint:a,inlinePKConstraint:T,inlineCheckConstraint:""}),{isActivated:e.isActivated})},hydrateDropDatabase(e){return{databaseName:e[0]?.name||""}},hydrateAlterDatabase({containerData:e,compModeData:t}){let s=e[0]||{},n=t.new.db_account!==t.old.db_account,a=t.new.db_default_map!==t.old.db_default_map,T=t.new.db_permanent_storage_size!==t.old.db_permanent_storage_size,I=t.new.spool_files_size!==t.old.spool_files_size,L=t.new.temporary_tables_size!==t.old.temporary_tables_size,C=t.new.has_fallback!==t.old.has_fallback,K=t.new.db_before_journaling_strategy!==t.old.db_before_journaling_strategy,P=t.new.db_after_journaling_strategy!==t.old.db_after_journaling_strategy,F=t.new.db_default_journal_db!==t.old.db_default_journal_db||t.new.db_default_journal_table!==t.old.db_default_journal_table,G=z(t);return{name:s.name||"",...n&&{db_account:s.db_account},...a&&{db_default_map:s.db_default_map},...T&&{db_permanent_storage_size:s.db_permanent_storage_size},...I&&{spool_files_size:s.spool_files_size},...L&&{temporary_tables_size:s.temporary_tables_size},...C&&{has_fallback:s.has_fallback},...K&&{db_before_journaling_strategy:s.db_before_journaling_strategy},...P&&{db_after_journaling_strategy:s.db_after_journaling_strategy},...F&&{db_default_journal_db:G?t.old.db_default_journal_db:s.db_default_journal_db,db_default_journal_table:G?t.old.db_default_journal_table:s.db_default_journal_table,dropDefaultJournalTable:G}}},hydrateDropTable({tableData:e,entityData:t}){let s=t[0];return{name:e.name,dbName:e.dbData.databaseName,temporary:s?.tableOptions?.TEMPORARY_VOLATILE==="GLOBAL TEMPORARY"}},hydrateAlterTable({name:e,newEntityData:t,oldEntityData:s}){let n=t[0]?.tableOptions||{},a=s[0]?.tableOptions||{},T=n.ERROR_TABLE!==a.ERROR_TABLE,I=n.FOR_TABLE!==a.FOR_TABLE,L=n.FOREIGN_TABLE!==a.FOREIGN_TABLE,C=n.SET_MULTISET!==a.SET_MULTISET,K=n.TEMPORARY_VOLATILE!==a.TEMPORARY_VOLATILE,P=n.QUEUE_TABLE!==a.QUEUE_TABLE,F=n.TRACE_TABLE!==a.TRACE_TABLE,G=n.EXTERNAL_SECURITY!==a.EXTERNAL_SECURITY,Y=n.AUTHORIZATION_NAME!==a.AUTHORIZATION_NAME,X=n.MAP!==a.MAP,k=n.COLOCATE_USING!==a.COLOCATE_USING,W=n.FALLBACK!==a.FALLBACK,Z=n.DEFAULT_JOURNAL_TABLE!==a.DEFAULT_JOURNAL_TABLE,J=n.LOG!==a.LOG,Ne=n.BEFORE_JOURNAL!==a.BEFORE_JOURNAL,Ie=n.AFTER_JOURNAL!==a.AFTER_JOURNAL,be=n.TABLE_CHECKSUM!==a.TABLE_CHECKSUM,ye=n.ISOLATED_LOADING!==a.ISOLATED_LOADING,fe=n.TABLE_PRESERVATION!==a.TABLE_PRESERVATION,Le=n.FREESPACE?.freeSpaceValue!==a.FREESPACE?.freeSpaceValue||n.FREESPACE?.percentUnit!==a.FREESPACE?.percentUnit,_e=n.MERGE_BLOCK_RATIO?.mergeRatio!==a.MERGE_BLOCK_RATIO?.mergeRatio||n.MERGE_BLOCK_RATIO?.specificRatio!==a.MERGE_BLOCK_RATIO?.specificRatio||n.MERGE_BLOCK_RATIO?.percentUnit!==a.MERGE_BLOCK_RATIO?.percentUnit,$e=n.DATA_BLOCK_SIZE.blockSize!==a.DATA_BLOCK_SIZE?.blockSize||n.DATA_BLOCK_SIZE?.specificSize!==a.DATA_BLOCK_SIZE?.specificSize||n.DATA_BLOCK_SIZE?.units!==a.DATA_BLOCK_SIZE?.units,ge=n.BLOCK_COMPRESSION?.blockCompressionType!==a.BLOCK_COMPRESSION?.blockCompressionType||n.BLOCK_COMPRESSION?.blockCompressionAlgorithm!==a.BLOCK_COMPRESSION?.blockCompressionAlgorithm||n.BLOCK_COMPRESSION?.blockCompressionLevel!==a.BLOCK_COMPRESSION?.blockCompressionLevel||n.BLOCK_COMPRESSION?.specificBlockCompressionLevel!==a.BLOCK_COMPRESSION?.specificBlockCompressionLevel,Be=n.USING?.location!==a.USING?.location||n.USING?.scanPercentage!==a.USING?.scanPercentage||n.USING?.pathPattern!==a.USING?.pathPattern||n.USING?.manifest!==a.USING?.manifest||n.USING?.tableFormat!==a.USING?.tableFormat||n.USING?.rowFormat!==a.USING?.rowFormat||n.USING?.storedAs!==a.USING?.storedAs||n.USING?.header!==a.USING?.header||n.USING?.stripSpaces!==a.USING?.stripSpaces||n.USING?.stripEnclosingChar!==a.USING?.stripEnclosingChar;return{name:e,tableOptions:{...T&&{ERROR_TABLE:n.ERROR_TABLE},...I&&{FOR_TABLE:n.FOR_TABLE},...L&&{FOREIGN_TABLE:n.FOREIGN_TABLE},...C&&{SET_MULTISET:n.SET_MULTISET},...K&&{TEMPORARY_VOLATILE:n.TEMPORARY_VOLATILE},...P&&{QUEUE_TABLE:n.QUEUE_TABLE},...F&&{TRACE_TABLE:n.TRACE_TABLE},...G&&{EXTERNAL_SECURITY:n.EXTERNAL_SECURITY},...Y&&{AUTHORIZATION_NAME:n.AUTHORIZATION_NAME},...X&&{MAP:n.MAP},...k&&{COLOCATE_USING:n.COLOCATE_USING},...W&&{FALLBACK:n.FALLBACK},...Z&&{DEFAULT_JOURNAL_TABLE:n.DEFAULT_JOURNAL_TABLE},...J&&{LOG:n.LOG},...Ne&&{BEFORE_JOURNAL:n.BEFORE_JOURNAL},...Ie&&{AFTER_JOURNAL:n.AFTER_JOURNAL},...be&&{TABLE_CHECKSUM:n.TABLE_CHECKSUM},...ye&&{ISOLATED_LOADING:n.ISOLATED_LOADING},...fe&&{TABLE_PRESERVATION:n.TABLE_PRESERVATION},...Le&&{FREESPACE:n.FREESPACE},..._e&&{MERGE_BLOCK_RATIO:n.MERGE_BLOCK_RATIO},...$e&&{DATA_BLOCK_SIZE:n.DATA_BLOCK_SIZE},...ge&&{BLOCK_COMPRESSION:n.BLOCK_COMPRESSION},...Be&&{USING:n.USING}}}},hydrateDropColumn({name:e}){return{name:e}},hydrateAlterColumn({newColumn:e,oldColumn:t,oldCompData:s,newCompData:n}){let a=A(e,t,["name","type"]),T={...e};return s.name!==n.name&&(T.oldName=s.name),s.type!==n.type&&(T.oldType=s.type),O.isEmpty(a)||(T.newOptions=a),T},hydrateDropView({tableData:e}){return{name:e.name,dbData:e.dbData}},hydrateAlterView({name:e,newEntityData:t,oldEntityData:s,viewData:n}){let a=this.hydrateView({viewData:{},entityData:t}),T=this.hydrateView({viewData:{},entityData:s}),I={};s[0]?.name!==t[0]?.name&&(I.oldName=s[0]?.name);let L=A(a,T);return{name:e,keys:n.keys,selectStatement:L.selectStatement||t[0]?.selectStatement,recursive:L.recursive||t[0]?.recursive,options:L,...I}},getDefaultType(e){return he[e]},getTypesDescriptors(){return Oe},hasType(e){return _(Oe,e)},dropDatabase(e){return E(S.dropDatabase,e)},alterDatabase(e){let t=j(e);return E(S.modifyDatabase,{databaseName:e.name,databaseOptions:t})},dropTable(e){return E(S.dropTable,{name:R(e.name,e.dbName),temporary:e.temporary?"TEMPORARY ":""})},alterTable(e,t){let s=R(e.name,t.databaseName),n=H(e.tableOptions,!0);return O.trim(n)?E(S.alterTable,{tableName:s,tableOptions:n}):""},dropColumn(e,t,s){let n=R(e,s.databaseName);return E(S.alterTable,{tableName:n,tableOptions:"",alterStatement:E(S.dropColumn,{name:d(t.name,'"','"')})})},addColumn(e,t,s){let n=R(e,s.databaseName);return E(S.alterTable,{tableName:n,tableOptions:"",alterStatement:E(S.addColumn,{columnDefinition:this.convertColumnDefinition(t)})})},renameColumn(e,t,s){let n=R(e,s.databaseName);return E(S.alterTable,{tableName:n,tableOptions:"",alterStatement:E(S.rename,{oldName:d(t.oldName,'"','"'),newName:d(t.name,'"','"')})})},alterColumn(e,t,s){let n=R(e,s.databaseName),a=[];if(t.oldName&&t.oldType||t.oldType){let T=this.dropColumn(e,{name:t.name},s),I=this.addColumn(e,{...t,isActivated:!0},s);a.push(T,I)}else if(t.oldName&&!t.newOptions){let T=this.renameColumn(e,t,s);a.push(T)}else if(t.oldName&&t.newOptions){let T=this.renameColumn(e,t,s),I=this.addColumn(e,{...t,isActivated:!0},s);a.push(T,I)}else{let T=this.addColumn(e,{...t,isActivated:!0},s);a.push(T)}return b(a.join(`

`),{isActivated:t.isActivated})},dropIndex(e,t,s){if(!t.indxName)return"";let n=R(e,s.databaseName);if(["PRIMARY","PRIMARY AMP"].includes(t.indexType))return"";if(!t.indexType||t.indexType==="SECONDARY")return E(S.dropSecondaryIndex,{indexName:d(t.indxName,'"','"'),tableName:n});let a=t.indexType?` ${t.indexType}`:"",T=w(t.indxName,s.databaseName);return E(S.dropIndex,{indexName:T,indexType:a})},alterIndex(e,{new:t,old:s},n){return[this.dropIndex(e,s,n),this.createIndex(e,{...t,indxKey:t.indxKey.filter(a=>a.isActivated!==!1)},n)].join(`

`)},dropView({name:e,dbData:t}){let s=R(e,t.databaseName);return E(S.dropView,{viewName:s})},alterView(e,t){let s=O.isEmpty(e.options),n=R(e.name,t.databaseName);if(e.oldName&&s){let a=R(e.oldName,t.databaseName);return E(S.renameView,{oldViewName:a,newViewName:n})}else if(s)return"";return[this.dropView({name:e.oldName||e.name,dbData:t}),this.createView(e,t,!0)].join(`

`)}})};
